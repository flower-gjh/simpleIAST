package com.keven1z.core.vulnerability.report;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.keven1z.core.graph.taint.TaintData;

import com.keven1z.core.utils.JsonUtils;
import com.keven1z.core.pojo.HttpDTO;
import com.keven1z.core.pojo.ReportDTO;

import java.util.LinkedList;
import java.util.Map;


/**
 * 构建漏洞报告json string
 */
public class ReportBuilder {
    public static String build(String agentId, String url, String method, Map<String,String> headers, byte[] httpMessage, String vulType, LinkedList<TaintData> taintLinkedList) throws JsonProcessingException {
        HttpDTO httpDTO = new HttpDTO(url, method, headers);
        httpDTO.setHttpMessage(httpMessage);
        ReportDTO reportDTO = new ReportDTO();
        reportDTO.setHttp(httpDTO);
        reportDTO.setAgentId(agentId);
        reportDTO.setTaintLinkList(taintLinkedList);
        reportDTO.setVulType(taintLinkedList.getLast().getVulnType());
        return JsonUtils.toString(reportDTO);
    }


}
